<!--BEGIN
HTTP/1.1 200 OK
Content-Type: text/html

<!DOCTYPE html>
<html lang="en">
  <meta charset="utf-8">
  <script>
    parent.postMessage('okay', '*');
  </script>
</html>
END-->
<!DOCTYPE html>
<html lang="en">
  <meta charset="utf-8">
  <title>All sorts of tests for request headers</title>
  <script src="/resources/testharness.js"></script>
  <script src="/resources/testharnessreport.js"></script>
  <script src="/fetch/metadata/resources/helper.js"></script>
  <body>
  <script>
  'use strict';

  promise_test(() => {
    const iframe = document.createElement('iframe');
    iframe.setAttribute('src', '/chop.py?pathname=' + location.pathname);

    return new Promise((resolve) => {
      addEventListener('message', function(event) {
        if (event.source === iframe.contentWindow) {
          resolve();
        }
      });

      document.body.appendChild(iframe);
    }).then(() => iframe.remove());
  });
  </script>
</html>
