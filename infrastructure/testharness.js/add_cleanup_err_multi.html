<!DOCTYPE HTML>
<html>
<head>
<meta name="variant" content="">
<meta name="variant" content="?remove-promise">
<title>Test#add_cleanup: multiple functions with one in error</title>
<script src="resources/variant-promise.js"></script>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
</head>
<body>
<div id="log"></div>

<script>
"use strict";

test(function(t) {
    t.add_cleanup(function() {
      throw new Error("exception in cleanup function");
    });

    // The following cleanup function defines a test so that the reported
    // data demonstrates the intended run-time behavior, i.e. that
    // `testharness.js` invokes all cleanup functions even when one or more
    // throw errors.
    t.add_cleanup(function() {
      test(function() {}, "Verification test");
    });
  }, "Test with multiple cleanup functions");
</script>
</body>
</html>
