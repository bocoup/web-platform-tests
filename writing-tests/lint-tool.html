
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lint Tool &#8212; web-platform-tests  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Manual Tests" href="manual.html" />
    <link rel="prev" title="Writing H2 Tests" href="h2tests.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="lint-tool">
<h1>Lint Tool<a class="headerlink" href="#lint-tool" title="Permalink to this headline">¶</a></h1>
<p>We have a lint tool for catching common mistakes in test files. You can run
it manually by running the <code class="docutils literal notranslate"><span class="pre">wpt</span> <span class="pre">lint</span></code> command from the root of your local
web-platform-tests working directory like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">wpt</span> <span class="n">lint</span>
</pre></div>
</div>
<p>The lint tool is also run automatically for every submitted pull request,
and reviewers will not merge branches with tests that have lint errors, so
you must either <a class="reference external" href="#fixing-lint-errors">fix all lint errors</a>, or you must
<a class="reference external" href="#updating-the-whitelist">whitelist test files</a> to suppress the errors.</p>
<div class="section" id="fixing-lint-errors">
<h2>Fixing lint errors<a class="headerlink" href="#fixing-lint-errors" title="Permalink to this headline">¶</a></h2>
<p>You must fix any errors the lint tool reports, unless an error is for
something essential to a certain test or that for some other
exceptional reason shouldn’t prevent the test from being merged; in
those cases you can <a class="reference external" href="#updating-the-whitelist">whitelist test files</a>
to suppress the errors. In all other cases, follow the instructions
below to fix all errors reported.</p>
<ul class="simple">
<li><strong>CONSOLE</strong>: Test-file line has a <code class="docutils literal notranslate"><span class="pre">console.*(...)</span></code> call; <strong>fix</strong>: remove
the <code class="docutils literal notranslate"><span class="pre">console.*(...)</span></code> call (and in some cases, consider adding an
<code class="docutils literal notranslate"><span class="pre">assert_*</span></code> of some kind in place of it).</li>
<li><strong>CR AT EOL</strong>: Test-file line ends with CR (U+000D) character; <strong>fix</strong>:
reformat file so each line just has LF (U+000A) line ending (standard,
cross-platform “Unix” line endings instead of, e.g., DOS line endings).</li>
<li><strong>EARLY-TESTHARNESSREPORT</strong>: Test file has an instance of
<code class="docutils literal notranslate"><span class="pre">&lt;script&nbsp;src='/resources/testharnessreport.js'&gt;</span></code> prior to
<code class="docutils literal notranslate"><span class="pre">&lt;script&nbsp;src='/resources/testharness.js'&gt;</span></code>; <strong>fix</strong>: flip the order.</li>
<li><strong>GENERATE_TESTS</strong>: Test file line has a generate_tests call; <strong>fix</strong>: remove
the call and call <code class="docutils literal notranslate"><span class="pre">test()</span></code> a number of times instead.</li>
<li><strong>INDENT TABS</strong>: Test-file line starts with one or more tab characters;
<strong>fix</strong>: use spaces to replace any tab characters at beginning of lines.</li>
<li><strong>INVALID-TIMEOUT</strong>: Test file with <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name='timeout'...&gt;</span></code> element
that has a <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute whose value is not <code class="docutils literal notranslate"><span class="pre">long</span></code>; <strong>fix</strong>:
replace the value of the <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute with <code class="docutils literal notranslate"><span class="pre">long</span></code>.</li>
<li><strong>LATE-TIMEOUT</strong>: Test file with <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name=&quot;timeout&quot;...&gt;</span></code> element after
<code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharnessreport.js'&gt;</span></code> element ; <strong>fix</strong>: move
the <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name=&quot;timeout&quot;...&gt;</span></code> element to precede the <code class="docutils literal notranslate"><span class="pre">script</span></code> element.</li>
<li><strong>LAYOUTTESTS APIS</strong>: Test file uses <code class="docutils literal notranslate"><span class="pre">eventSender</span></code>, <code class="docutils literal notranslate"><span class="pre">testRunner</span></code>, or
<code class="docutils literal notranslate"><span class="pre">internals</span></code> which are LayoutTests-specific APIs used in WebKit/Blink.</li>
<li><strong>MALFORMED-VARIANT</strong>: Test file with a <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name='variant'...&gt;</span></code>
element whose <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute has a malformed value; <strong>fix</strong>: ensure
the value of the <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute starts with <code class="docutils literal notranslate"><span class="pre">?</span></code> or <code class="docutils literal notranslate"><span class="pre">#</span></code> or is empty.</li>
<li><strong>MISSING-LINK</strong>: CSS test file is missing a link to a spec. <strong>fix</strong>: Ensure that there is a <code class="docutils literal notranslate"><span class="pre">&lt;link</span> <span class="pre">rel=&quot;help&quot;</span> <span class="pre">href=&quot;[url]&quot;&gt;</span></code> for the spec.<ul>
<li>Note: <code class="docutils literal notranslate"><span class="pre">MISSING-LINK</span></code> is designed to ensure that the CSS build tool can find the tests. Note that the CSS build system is primarily used by <a class="reference external" href="http://test.csswg.org/">test.csswg.org/</a>, which doesn’t use <code class="docutils literal notranslate"><span class="pre">wptserve</span></code>, so <code class="docutils literal notranslate"><span class="pre">*.any.js</span></code> and similar tests won’t work there; stick with the <code class="docutils literal notranslate"><span class="pre">.html</span></code> equivalent.</li>
</ul>
</li>
<li><strong>MISSING-TESTHARNESSREPORT</strong>: Test file is missing an instance of
<code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharnessreport.js'&gt;</span></code>; <strong>fix</strong>: ensure each
test file contains <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharnessreport.js'&gt;</span></code>.</li>
<li><strong>MULTIPLE-TESTHARNESS</strong>: Test file with multiple instances of
<code class="docutils literal notranslate"><span class="pre">&lt;script&nbsp;src='/resources/testharness.js'&gt;</span></code>; <strong>fix</strong>: ensure each test
has only one <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharness.js'&gt;</span></code> instance.</li>
<li><strong>MULTIPLE-TESTHARNESSREPORT</strong>: Test file with multiple instances of
<code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharnessreport.js'&gt;</span></code>; <strong>fix</strong>: ensure each test
has only one <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">src='/resources/testharnessreport.js'&gt;</span></code> instance.</li>
<li><strong>MULTIPLE-TIMEOUT</strong>: Test file with multiple <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name=&quot;timeout&quot;...&gt;</span></code>
elements; <strong>fix</strong>: ensure each test file has only one instance of a
<code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name=&quot;timeout&quot;...&gt;</span></code> element.</li>
<li><strong>PARSE-FAILED</strong>: Test file failed parsing by manifest builder; <strong>fix</strong>:
examine the file to find the causes of any parse errors, and fix them.</li>
<li><strong>PATH LENGTH</strong>: Test file’s pathname has a total length greater than 150
characters; <strong>fix</strong>: use shorter filename to rename the test file.</li>
<li><strong>PRINT STATEMENT</strong>: A server-side python support file contains a <code class="docutils literal notranslate"><span class="pre">print</span></code>
statement; <strong>fix</strong>: remove the <code class="docutils literal notranslate"><span class="pre">print</span></code> statement or replace it with
something else that achieves the intended effect (e.g., a logging call).</li>
<li><strong>SET TIMEOUT</strong>: Test-file line has <code class="docutils literal notranslate"><span class="pre">setTimeout(...)</span></code> call; <strong>fix</strong>:
replace all <code class="docutils literal notranslate"><span class="pre">setTimeout(...)</span></code> calls with <code class="docutils literal notranslate"><span class="pre">step_timeout(...)</span></code> calls.</li>
<li><strong>TRAILING WHITESPACE</strong>: Test-file line has trailing whitespace; <strong>fix</strong>:
remove trailing whitespace from all lines in the file.</li>
<li><strong>VARIANT-MISSING</strong>: Test file with a <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name='variant'...&gt;</span></code> element
that’s missing a <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute; <strong>fix</strong>: add a <code class="docutils literal notranslate"><span class="pre">content</span></code> attribute
with an appropriate value to the <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name='variant'...&gt;</span></code> element.</li>
<li><strong>W3C-TEST.ORG</strong>: Test-file line has the string <code class="docutils literal notranslate"><span class="pre">w3c-test.org</span></code>; <strong>fix</strong>:
either replace the <code class="docutils literal notranslate"><span class="pre">w3c-test.org</span></code> string with the expression
<code class="docutils literal notranslate"><span class="pre">{{host}}:{{ports[http][0]}}</span></code> or a generic hostname like <code class="docutils literal notranslate"><span class="pre">example.org</span></code>.</li>
</ul>
</div>
<div class="section" id="updating-the-whitelist">
<h2>Updating the whitelist<a class="headerlink" href="#updating-the-whitelist" title="Permalink to this headline">¶</a></h2>
<p>Normally you must <a class="reference external" href="#fixing-lint-errors">fix all lint errors</a>. But in the
unusual case of error reports for things essential to certain tests or that
for other exceptional reasons shouldn’t prevent a merge of a test, you can
update and commit the <code class="docutils literal notranslate"><span class="pre">lint.whitelist</span></code> file in the web-platform-tests root
directory to suppress errors the lint tool would report for a test file.</p>
<p>To add a test file or directory to the whitelist, use the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ERROR</span> <span class="n">TYPE</span><span class="p">:</span><span class="n">file</span><span class="o">/</span><span class="n">name</span><span class="o">/</span><span class="n">pattern</span>
</pre></div>
</div>
<p>For example, to whitelist the file <code class="docutils literal notranslate"><span class="pre">example/file.html</span></code> such that all
<code class="docutils literal notranslate"><span class="pre">TRAILING</span> <span class="pre">WHITESPACE</span></code> errors the lint tool would report for it are
suppressed, add the following line to the <code class="docutils literal notranslate"><span class="pre">lint.whitelist</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRAILING</span> <span class="n">WHITESPACE</span><span class="p">:</span><span class="n">example</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>To whitelist an entire directory rather than just one file, use the <code class="docutils literal notranslate"><span class="pre">*</span></code>
wildcard. For example, to whitelist the <code class="docutils literal notranslate"><span class="pre">example</span></code> directory such that all
<code class="docutils literal notranslate"><span class="pre">TRAILING</span> <span class="pre">WHITESPACE</span></code> errors the lint tool would report for any files in it
are suppressed, add the following line to the <code class="docutils literal notranslate"><span class="pre">lint.whitelist</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRAILING</span> <span class="n">WHITESPACE</span><span class="p">:</span><span class="n">example</span><span class="o">/*</span>
</pre></div>
</div>
<p>Similarly, you can also
use
<a class="reference external" href="https://docs.python.org/2/library/fnmatch.html">shell-style wildcards</a> to
express other filename patterns or directory-name patterns.</p>
<p>Finally, to whitelist just one line in a file, use the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ERROR</span> <span class="n">TYPE</span><span class="p">:</span><span class="n">file</span><span class="o">/</span><span class="n">name</span><span class="o">/</span><span class="n">pattern</span><span class="p">:</span><span class="n">line_number</span>
</pre></div>
</div>
<p>For example, to whitelist just line 128 of the file <code class="docutils literal notranslate"><span class="pre">example/file.html</span></code>
such that any <code class="docutils literal notranslate"><span class="pre">TRAILING</span> <span class="pre">WHITESPACE</span></code> error the lint tool would report for
that line is suppressed, add the following to the <code class="docutils literal notranslate"><span class="pre">lint.whitelist</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRAILING</span> <span class="n">WHITESPACE</span><span class="p">:</span><span class="n">example</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">html</span><span class="p">:</span><span class="mi">128</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">web-platform-tests</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../test-suite-design.html">Test Suite Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-tests/index.html">Running Tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Writing Tests</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="general-guidelines.html">General Test Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="ahem.html">The Ahem Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="assumptions.html">Test Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="css-metadata.html">CSS Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="css-user-styles.html">CSS User Stylesheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-names.html">File Name Flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="h2tests.html">Writing H2 Tests</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lint Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual.html">Manual Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="reftest-tutorial.html">Writing a reftest</a></li>
<li class="toctree-l2"><a class="reference internal" href="reftests.html">Reftests</a></li>
<li class="toctree-l2"><a class="reference internal" href="rendering.html">Rendering Test Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-features.html">Server Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="submission-process.html">Submitting Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="testdriver.html">testdriver.js Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="testdriver-tutorial.html">testdriver.js Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="testharness.html">testharness.js Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Command-line utility scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="visual.html">Visual Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="wdspec.html">wdspec tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="test-templates.html">Test Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="github-intro.html">Introduction to GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#test-type">Test Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#submitting-tests">Submitting Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reviewing-tests/index.html">Reviewing Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin/index.html">Project Administration</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Writing Tests</a><ul>
      <li>Previous: <a href="h2tests.html" title="previous chapter">Writing H2 Tests</a></li>
      <li>Next: <a href="manual.html" title="next chapter">Manual Tests</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, wpt contributors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/writing-tests/lint-tool.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>