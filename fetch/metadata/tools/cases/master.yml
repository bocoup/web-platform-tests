---
- title: Fetch Metadata - Sec-Fetch-Site - redirection
  headerName: sec-fetch-site
  all_subtests:
    - description: Cross-Site -> Same-Origin
      pathPrefix: "\
        https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{host}}:{{ports[https][0]}}"
      expected: cross-site
    - description: Cross-Site -> Same-Site
      pathPrefix: "\
        https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{domains[www2]}}:{{ports[https][0]}}"
      expected: cross-site
    - description: Cross-Site -> Cross-Site
      pathPrefix: "\
        https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{hosts[alt][]}}:{{ports[https][0]}}"
      expected: cross-site
    - description: Same-Origin -> Cross-Site -> Same-Origin
      pathPrefix: "\
        https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{host}}:{{ports[https][0]}}"
      expected: cross-site
    - description: HTTPS downgrade-upgrade
      pathPrefix: "\
        https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
        http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
        https://{{host}}:{{ports[https][0]}}"
      expected: cross-site
  each_subtest:
    appcache-manifest.sub.https.html: [{}]
    fetch.sub.html: [{}]
    form-submission.sub.html:
      - description: GET
        method: GET
      - description: POST
        method: POST
    global-properties.sub.html:
      - description: location
        api: location
      - description: location.href
        api: location.href
      - description: location.assign
        api: location.assign
      - description: location.replace
        api: location.replace
    image.sub.html: [{}]
    script-element.sub.html:
      - description: classic script
      - description: module script
        elementAttrs:
          type: module
    script-module-import-dynamic.sub.html: [{}]
    script-module-import-static.sub.html: [{}]
    video-poster.sub.html: [{}]

- title: Fetch Metadata - Sec-Fetch-Mode
  headerName: sec-fetch-mode
  each_subtest:
    appcache-manifest.sub.https.html:
      - expected: no-cors
    fetch.sub.html:
      - description: no options
        expected: cors
      - description: 'mode: cors'
        expected: cors
        init: { mode: cors }
      - description: 'mode: no-cors'
        expected: no-cors
        init: { mode: no-cors }
      - description: 'mode: same-origin'
        expected: same-origin
        init: { mode: same-origin }
    form-submission.sub.html:
      - description: GET
        method: GET
        expected: navigate
      - description: POST
        method: POST
        expected: navigate
    global-properties.sub.html:
      - description: location
        api: location
        expected: navigate
      - description: location.href
        api: location.href
        expected: navigate
      - description: location.assign
        api: location.assign
        expected: navigate
      - description: location.replace
        api: location.replace
        expected: navigate
    image.sub.html:
      - description: no attributes
        expected: no-cors
      - description: crossorigin=""
        expected: cors
        elementAttrs:
          crossorigin: ''
      - description: crossorigin="anonymous"
        expected: cors
        elementAttrs:
          crossorigin: anonymous
      - description: crossorigin="use-credentials"
        expected: cors
        elementAttrs:
          crossorigin: use-credentials
    script-element.sub.html:
      - description: classic script
        expected: no-cors
      - description: module script
        expected: cors
        elementAttrs:
          type: module
      - description: classic script, crossorigin=""
        expected: cors
        elementAttrs:
          crossorigin: ''
      - description: classic script, crossorigin="anonymous"
        expected: cors
        elementAttrs:
          crossorigin: anonymous
      - description: classic script, crossorigin="use-credentials"
        expected: cors
        elementAttrs:
          crossorigin: use-credentials
    script-module-import-dynamic.sub.html:
      - expected: cors
    script-module-import-static.sub.html:
      - expected: cors
    video-poster.sub.html:
      - expected: no-cors
