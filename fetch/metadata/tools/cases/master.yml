---
- templates: '*'
  file_name_part: sec-fetch-site-redirect.https
  title: Fetch Metadata - Sec-Fetch-Site - redirection
  headerName: sec-fetch-site
  requests:
  - description: Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site

  - description: Cross-Site -> Same-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{domains[www2]}}:{{ports[https][0]}}"
    expected: cross-site

  - description: Cross-Site -> Cross-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}"
    expected: cross-site

  - description: Same-Origin -> Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site

  - description: HTTPS downgrade-upgrade
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site

- templates: '*'
  file_name_part: sec-fetch-mode-redirect
  title: Fetch Metadata - Sec-Fetch-Mode - redirection
  headerName: sec-fetch-mode
  requests:
  - description: Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors

  - description: Cross-Site -> Same-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{domains[www]}}:{{ports[https][0]}}"
    expected: no-cors

  - description: Cross-Site -> Cross-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}"
    expected: no-cors

  - description: Same-Origin -> Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors

  - description: HTTPS downgrade-upgrade
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors
