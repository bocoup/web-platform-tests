---
- templates: '*'
  file_name_part: sec-fetch-site-redirect.https
  title: Fetch Metadata - Sec-Fetch-Site - redirection
  headerName: sec-fetch-site
  requests:
  - description: Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site
  - description: Cross-Site -> Same-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{domains[www2]}}:{{ports[https][0]}}"
    expected: cross-site
  - description: Cross-Site -> Cross-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}"
    expected: cross-site
  - description: Same-Origin -> Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site
  - description: HTTPS downgrade-upgrade
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: cross-site

- templates:
  - appcache-manifest.sub.https.html
  - image.sub.html
  - js-module-via-script.sub.html
  - video-poster.sub.html
  file_name_part: sec-fetch-mode-redirect
  title: Fetch Metadata - Sec-Fetch-Mode - redirection
  headerName: sec-fetch-mode
  requests:
  - description: Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors
  - description: Cross-Site -> Same-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{domains[www]}}:{{ports[https][0]}}"
    expected: no-cors
  - description: Cross-Site -> Cross-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}"
    expected: no-cors
  - description: Same-Origin -> Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors
  - description: HTTPS downgrade-upgrade
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: no-cors

- templates:
  - script-module-via-import-dynamic.sub.html
  - script-module-via-import-static.sub.html
  - script-module-via-script.sub.html
  file_name_part: sec-fetch-mode-cors-script
  title: Fetch Metadata - Sec-Fetch-Mode - scripts
  headerName: sec-fetch-mode
  requests:
  - description: No attributes
    elementAttrs:
      crossorigin: ''
    expected: cors
  - description: crossorigin=""
    elementAttrs:
      crossorigin: ''
    expected: cors
  - description: crossorigin="anonymous"
    elementAttrs:
      crossorigin: anonymous
    expected: cors
  - description: crossorigin="use-credentials"
    elementAttrs:
      crossorigin: use-credentials
    expected: cors

- templates:
  - form-post.sub.html
  - form-get.sub.html
  file_name_part: sec-fetch-mode-navigate-redirect
  title: Fetch Metadata - Sec-Fetch-Mode - navigation redirection
  headerName: sec-fetch-mode
  requests:
  - description: Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: navigate
  - description: Cross-Site -> Same-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{domains[www]}}:{{ports[https][0]}}"
    expected: navigate
  - description: Cross-Site -> Cross-Site
    pathPrefix: "\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}"
    expected: navigate
  - description: Same-Origin -> Cross-Site -> Same-Origin
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{hosts[alt][]}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: navigate
  - description: HTTPS downgrade-upgrade
    pathPrefix: "\
      https://{{host}}:{{ports[https][0]}}/fetch/api/resources/redirect.py?location=\
      http://{{host}}:{{ports[http][0]}}/fetch/api/resources/redirect.py?location=\
      https://{{host}}:{{ports[https][0]}}"
    expected: navigate
