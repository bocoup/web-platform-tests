---
insecure.tentative:
  title: Fetch metadata request headers - form submission from an insecure context
  requests:
  - title: GET
    method: GET
    expectations:
      sec-fetch-site: NULL
      sec-fetch-user: NULL
      sec-fetch-mode: NULL
      sec-fetch-dest: NULL
  - title: POST
    method: POST
    expectations:
      sec-fetch-site: NULL
      sec-fetch-user: NULL
      sec-fetch-mode: NULL
      sec-fetch-dest: NULL

redirect.https.tentative:
  title: Fetch metadata request headers, redirection on form submission
  scripts:
    - /common/get-host-info.sub.js
  requests:
  - title: Cross-Site -> Same-Origin redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: navigate
      sec-fetch-dest: document

  - title: Cross-Site -> Same-Site redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'AUTHENTICATED_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: navigate
      sec-fetch-dest: document

  - title: Cross-Site -> Cross-Site redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'HTTPS_REMOTE_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: navigate
      sec-fetch-dest: document

  - title: Same-Origin -> Cross-Site -> Same-Origin redirect
    pathPrefix: chain('HTTPS_ORIGIN', 'HTTPS_REMOTE_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: navigate
      sec-fetch-dest: document

  - title: HTTPS downgrade-upgrade
    pathPrefix: chain('HTTPS_ORIGIN', 'HTTP_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: navigate
      sec-fetch-dest: document
