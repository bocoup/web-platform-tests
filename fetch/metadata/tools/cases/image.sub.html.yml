---
redirect.tentative:
  title: Fetch metadata request headers, redirection on images
  scripts:
    - /common/get-host-info.sub.js
    - /fetch/metadata/resources/helper.sub.js
  requests:
  - title: Cross-Site -> Same-Origin redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: no-cors
      sec-fetch-dest: image

  - title: Cross-Site -> Same-Site redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'AUTHENTICATED_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: no-cors
      sec-fetch-dest: image

  - title: Cross-Site -> Cross-Site redirect
    pathPrefix: chain('HTTPS_REMOTE_ORIGIN', 'HTTPS_REMOTE_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: no-cors
      sec-fetch-dest: image

  - title: Same-Origin -> Cross-Site -> Same-Origin redirect
    pathPrefix: chain('HTTPS_ORIGIN', 'HTTPS_REMOTE_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: no-cors
      sec-fetch-dest: image

  - title: HTTPS downgrade-upgrade
    pathPrefix: chain('HTTPS_ORIGIN', 'HTTP_ORIGIN', 'HTTPS_ORIGIN')
    expectations:
      sec-fetch-site: cross-site
      sec-fetch-user: NULL
      sec-fetch-mode: no-cors
      sec-fetch-dest: image
